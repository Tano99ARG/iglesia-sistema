<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Iglesia - Casa De Dios</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- EmailJS -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <style>
        /* ... (todo el CSS existente se mantiene igual) ... */
    </style>
</head>
<body>
    <!-- ... (todo el HTML existente se mantiene igual) ... -->

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <!-- CONFIGURACI√ìN INLINE -->
    <script>
        window.EMAILJS_CONFIG = {
            SERVICE_ID: 'service_mwog2jm',
            TEMPLATE_ID: 'template_wc3t3it', 
            PUBLIC_KEY: 'PXJT-sYDto3IXyn1a',
            USER_ID: 'Valentin'
        };

        window.BACKEND_CONFIG = {
            BASE_URL: 'https://personas-backend-v2.onrender.com',
            API_TIMEOUT: 10000
        };

        window.IGLESIA_CONFIG = {
            NOMBRE: 'Casa De Dios',
            EMAIL: 'valentin.alvarez.gg@gmail.com',
            TELEFONO: '+543517736190'
        };

        console.log('‚öôÔ∏è Configuraci√≥n del sistema cargada');
    </script>
    
    <!-- Servicios esenciales -->
    <script src="js/services/backend-real.js"></script>
    <script src="js/services/emailjs-real.js"></script>
    <script src="js/services/whatsapp-real.js"></script>
    
    <!-- M√≥dulos principales (solo los que existen) -->
    <script src="js/app.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/personas.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/dashboard.js"></script>

    <!-- Script de Autenticaci√≥n (inline) -->
    <script>
        // Controlador de interfaz de autenticaci√≥n
        class AuthUIController {
            constructor() {
                this.initEventListeners();
                console.log('üé® AuthUIController inicializado');
            }

            initEventListeners() {
                // Toggle de visibilidad de contrase√±as
                const toggleLogin = document.getElementById('toggleLoginPassword');
                const toggleRegister = document.getElementById('toggleRegisterPassword');
                
                if (toggleLogin) {
                    toggleLogin.addEventListener('click', () => {
                        this.togglePasswordVisibility('loginPassword', 'toggleLoginPassword');
                    });
                }

                if (toggleRegister) {
                    toggleRegister.addEventListener('click', () => {
                        this.togglePasswordVisibility('registerPassword', 'toggleRegisterPassword');
                    });
                }

                // Env√≠o de formularios
                const loginForm = document.getElementById('loginForm');
                const registerForm = document.getElementById('registerForm');
                
                if (loginForm) {
                    loginForm.addEventListener('submit', (e) => this.handleLogin(e));
                }
                if (registerForm) {
                    registerForm.addEventListener('submit', (e) => this.handleRegister(e));
                }
            }

            togglePasswordVisibility(passwordFieldId, toggleButtonId) {
                const passwordField = document.getElementById(passwordFieldId);
                const toggleButton = document.getElementById(toggleButtonId);
                if (!passwordField || !toggleButton) return;

                const icon = toggleButton.querySelector('i');
                if (passwordField.type === 'password') {
                    passwordField.type = 'text';
                    icon.className = 'fas fa-eye-slash';
                } else {
                    passwordField.type = 'password';
                    icon.className = 'fas fa-eye';
                }
            }

            async handleLogin(e) {
                e.preventDefault();
                const button = document.getElementById('loginButton');
                if (!button) return;

                const originalText = button.innerHTML;
                button.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Iniciando...';
                button.disabled = true;

                try {
                    const identifier = document.getElementById('loginIdentifier').value;
                    const password = document.getElementById('loginPassword').value;

                    // Simular login por ahora
                    if (identifier && password) {
                        this.showAlert('‚úÖ Inicio de sesi√≥n simulado correctamente', 'success');
                        setTimeout(() => {
                            document.getElementById('authSection').classList.add('hidden');
                            document.getElementById('mainSection').classList.remove('hidden');
                        }, 1000);
                    } else {
                        this.showAlert('‚ùå Por favor completa todos los campos', 'danger');
                    }
                } catch (error) {
                    this.showAlert('‚ùå Error al iniciar sesi√≥n', 'danger');
                } finally {
                    button.innerHTML = originalText;
                    button.disabled = false;
                }
            }

            async handleRegister(e) {
                e.preventDefault();
                this.showAlert('‚úÖ Registro simulado correctamente', 'success');
            }

            showAlert(message, type) {
                const alertsContainer = document.getElementById('authAlerts');
                if (!alertsContainer) return;

                const alertDiv = document.createElement('div');
                alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
                alertDiv.innerHTML = `${message}<button type="button" class="btn-close" data-bs-dismiss="alert"></button>`;
                alertsContainer.appendChild(alertDiv);
                
                setTimeout(() => alertDiv.remove(), 5000);
            }
        }

        // Inicializar cuando el DOM est√© listo
        document.addEventListener('DOMContentLoaded', function() {
            window.authUI = new AuthUIController();
        });

        // Funciones globales para navegaci√≥n
        function showLogin() {
            const forgotSection = document.getElementById('forgotPasswordSection');
            const authTabs = document.getElementById('authTabs');
            if (forgotSection) forgotSection.classList.add('hidden');
            if (authTabs) authTabs.classList.remove('hidden');
        }

        function showForgotPassword() {
            const forgotSection = document.getElementById('forgotPasswordSection');
            const authTabs = document.getElementById('authTabs');
            if (forgotSection) forgotSection.classList.remove('hidden');
            if (authTabs) authTabs.classList.add('hidden');
        }
    </script>
</body>
</html>
